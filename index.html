<!DOCTYPE html>
<html lang="ja">

  <head>
    <title>audit</title>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="audit">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"></script>
    <style>body { margin: 0; } #chart { max-width: 100vw; }</style>
  </head>

  <body class="container">
    <canvas id="chart"></canvas>

    <script>
var canvas = document.getElementById('chart');
canvas.width = 3000;
canvas.height = 1000;

var xhr = new XMLHttpRequest();
xhr.open("GET", "res.tsv", true);
xhr.send(null);
xhr.onload = function () {
    var lines = xhr.responseText.split("\n");

    var colLabels = lines.shift().split("\t");
    colLabels.shift();

    var setLabels = [];
    var datasets = colLabels.map((label) => []);

    lines.forEach((line) => {
        if (line !== "") {
            var cols = line.split("\t");
            cols.forEach((col, ix) => {
                if (ix == 0) setLabels.push(col);
                else datasets[ix - 1].push(col);
            });
        }
    });

    datasets.pop();

    new Chart(canvas.getContext('2d'), {
        type: 'line',
        data: {
            labels: setLabels,
            datasets: datasets.map((ds, ix) => ({
                label: colLabels[ix],
                data: ds
            }))
        },
        options: {
            scales: {
                yAxes: [{
                    ticks: {
                        beginAtZero: true
                    }
                }]
            }
        }
    });
};
    </script>
  </body>

</html>
