<!DOCTYPE html>
<html lang="ja">

  <head>
    <title>audit</title>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="audit">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"></script>
    <style>body { margin: 0; } #chart { max-width: 100vw; }</style>
  </head>

  <body class="container">
    <canvas id="chart"></canvas>

    <script>
var canvas = document.getElementById('chart');
canvas.width = 3000;
canvas.height = 1000;

var xhr = new XMLHttpRequest();
xhr.open("GET", "res.tsv", true);
xhr.send(null);
xhr.onload = function () {
    var lines = xhr.responseText.split("\n").filter((line) => (
        !!line.length
    )).map((line) => (
        line.split("\t")
    ));

    var colLabels = lines.shift();
    colLabels.shift(); // drop "Timestamp"

    var setLabels = lines.map((line) => line.shift()); // Timestamps
    var datasets = colLabels.map(() => lines.map((line) => line.shift()));

    new Chart(canvas.getContext('2d'), {
        type: 'line',
        data: {
            labels: setLabels,
            datasets: [0, 1, 2, 3, 4, 5, 7].map((ix) => ({
                label: colLabels[ix],
                yAxisID: ix == 7 ? 'B' : 'A',
                data: datasets[ix],
                backgroundColor: ix == 7 ? 'rgba(0, 128, 255, 0.2)' : 'rgba(0, 0, 0, 0.05)',
            }))
        },
        options: {
            scales: {
                yAxes: [
                    {
                        id: 'A',
                        type: 'linear',
                        position: 'left',
                        ticks: { beginAtZero: true, suggestedMax: 2500 }
                    },
                    {
                        id: 'B',
                        type: 'linear',
                        position: 'right',
                        ticks: { beginAtZero: true, suggestedMax: 0.1 }
                    }
                ]
            }
        }
    });
};
    </script>
  </body>

</html>
